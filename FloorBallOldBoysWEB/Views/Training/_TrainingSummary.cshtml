@model TrainingsViewModel


@foreach (var training in Model.Tranings)
{
    <section class="panel panel-primary">
        <div class="panel-heading">
            <h2>@training.Location</h2>
            <h4>@training.Date.DayOfWeek  @training.StartTime.Hour:@training.StartTime.Minute - @training.EndTime.Hour:@training.EndTime.Minute</h4>
            <h6>@training.Date.Year/@training.Date.Month/@training.Date.Day</h6>
        </div>
        <div class="panel-body">

            <div>
                <table class="table table-striped">
                    <tr>
                        <th><h4 class="h3">Anmälda deltagare</h4></th>
                    </tr>
                    <tr>
                        <td>
                            @foreach (var userTraningEnrollment in training.EnrolledUsers)
                            {
                                
                                @Html.Partial("_UserSummary", userTraningEnrollment)
                            }
                        </td>
                    </tr>
                </table>
                <hr class="divider" />
                <div>@training.Info</div>

            </div>
        </div>
        <div class="panel-footer">
            <table>
                <tr>
                    <th>
                        <form asp-controller="Training" onsubmit="return checkBeforeSubmit()">
                            @if (training.EnrolledUsers.Any(ute => ute.User.Email == User.Identity.Name))
                            {
                                <input class="btn-primary" type="submit" value="Ångra anmälan" asp-action="DismissTraining"
                                       asp-route-trainingId="@training.Id" asp-route-returnUrl="@Model.ReturnUrl" />
                            }
                            else
                            {
                                <input class="btn-primary" type="submit" value="Kommer" asp-action="EnrollTraining"
                                       asp-route-trainingId="@training.Id" asp-route-returnUrl="@Model.ReturnUrl" />
                            }
                        </form>
                    </th>
                    <th>
                        <div class="col-lg-12">
                            @if (Model.IsAdmin)
                            {
                                <a asp-action="Edit" asp-controller="Training"
                                   asp-route-trainingId="@training.Id" asp-route-returnUrl="@Model.ReturnUrl">Ändra</a>
                                <a asp-action="Delete" asp-controller="Training"
                                   asp-route-trainingId="@training.Id" asp-route-returnUrl="@Model.ReturnUrl">Ta bort</a>

                            }
                        </div>
                    </th>
                </tr>
            </table>


        </div>
    </section>
}

